#!/bin/bash

source `dirname $0`/../colors.bash

git_pager() {
        if test -t 1
        then
                GIT_PAGER=$(git var GIT_PAGER)
        else
                GIT_PAGER=cat
        fi
        : ${LESS=-FRSX}
        export LESS
        eval "$GIT_PAGER" '"$@"'
}

while read line; do (
  cd $line;
  wd=$(pwd);
  echo -e "${LIGHT_BLUE}${wd/$HOME/~}${NC}"; 
  git --no-pager diff --stat ..@{upstream};
) done <$HOME/.mgitrepos |git_pager
